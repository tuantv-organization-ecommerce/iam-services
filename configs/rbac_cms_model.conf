# Casbin RBAC Model for CMS Authorization
# This model is used for admin/staff permissions on CMS

[request_definition]
r = sub, tab, api, act

[policy_definition]
p = sub, tab, api, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub) && r.tab == p.tab && keyMatch2(r.api, p.api) && regexMatch(r.act, p.act)

# Explanation:
# - sub (subject): User ID or CMS Role name
# - tab: CMS tab name (e.g., "product", "inventory", "order", "report")
# - api: API path within the tab (e.g., /api/v1/products/*)
# - act (action): HTTP method (e.g., GET, POST, (GET|POST|PUT|DELETE))
#
# Note: Tab-to-API mapping is stored in cms_tab_apis table
#
# Example policies:
# p, cms_admin, product, /api/v1/products/*, (GET|POST|PUT|DELETE)
# p, cms_admin, inventory, /api/v1/inventory/*, (GET|POST|PUT|DELETE)
# p, cms_product_manager, product, /api/v1/products/*, (GET|POST|PUT)
# p, cms_viewer, product, /api/v1/products/*, GET
#
# Example role assignments:
# g, user-123, cms_admin
# g, user-456, cms_product_manager

